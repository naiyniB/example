<!doctype html>
<html>
  <body>
    <h2>原生 WebSocket 聊天室</h2>
    <input type="text" id="messageInput" placeholder="输入消息..." />
    <button onclick="send()">发送</button>
    <div id="chatBox"></div>

    <script>
      // 1. 创建原生 WebSocket 实例
      const socket = new WebSocket("ws://localhost:8080");

      // 2. 监听连接打开
      socket.onopen = () => {
        console.log("已连接到服务器");
        document.getElementById("chatBox").innerHTML +=
          "<p>系统：连接成功！</p>";
      };

      // 3. 监听服务器发来的消息
      socket.onmessage = (event) => {
        const chatBox = document.getElementById("chatBox");
        chatBox.innerHTML += `<p>收到：${event.data}</p>`;
      };

      // 发送消息的函数
      function send() {
        const input = document.getElementById("messageInput");
        socket.send(input.value); // 发送纯文本
        input.value = "";
      }
    </script>
  </body>
</html>
